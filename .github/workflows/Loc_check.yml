name: Check String Length in CSV

on:
  workflow_dispatch:
    inputs:
      event_name:
        description: 'Event name prefix to check'
        required: true

jobs:
  check_csv123:
    runs-on: ubuntu-22.04

    steps:
    - uses: actions/checkout@v4
        with:
          persist-credentials: false
      - name: Authenticate to Google Cloud Storage
        uses: google-github-actions/auth@v2
        with:
          create_credentials_file: true
          workload_identity_provider: ${{ secrets.GCP_WIF_FI_CLIENT_PROVIDER }}
          service_account: ${{ secrets.GCP_WIF_FI_CLIENT_QA_CLIENT_DEV_1 }}

    - name: Checkout the repository
      uses: actions/checkout@v4
      with:
          persist-credentials: false

    - name: Set up Python
      uses: actions/setup-python@v3
      with:
        python-version: '3.x'

    - name: Check string length in CSV
      run: |
        python .github/actions/check_csv.py ${{ github.event.inputs.event_name }}
